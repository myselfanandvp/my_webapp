{% extends 'shared/base.html' %}
{% load static %}

{% block content %}
<div class="font-inter min-h-screen bg-gray-100 p-4 sm:p-6 lg:p-8">
  <!-- Referral Page Header -->
  <div class="max-w-7xl mx-auto">
    <h1 class="text-4xl font-bold text-gray-700 mb-6 uppercase text-center">Referral
    </h1>

    <!-- Summary Card -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
      <div class="flex items-center gap-4">
        <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <div>
          <h2 class="text-2xl font-semibold text-gray-800">&#8377; {{total_welcome_amount |floatformat:2|default:"0.00" }}</h2>
          <p class="text-sm text-gray-600">Total Referral Earnings</p>
        </div>
      </div>
    </div>

      <!-- Summary Card -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
      <div class="flex items-center gap-4">
        <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <div>
          <h2 class="text-2xl font-semibold text-gray-800">&#8377; {{ total_referred_amount|floatformat:2|default:"0.00" }}</h2>
          <p class="text-sm text-gray-600">Total Reffered Earnings</p>
        </div>
      </div>
    </div>

    <!-- Referrals Table -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Referral Details</h2>
      {% if referrals %}
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Referrer</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Referrals</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Referrer Earning (₹)</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Referrals Earning (₹)</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for ref in referrals %}
            <tr>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {{ ref.referrer.username }} ({{ ref.referrer.email }})
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {{ ref.referred.username }}  ({{ ref.referred.email }})
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
             
                {%for wallet in ref.referrer.wallet.transactions.all%}
                  {%if wallet.referral_amount %}
                    ₹{{wallet.referral_amount | floatformat:2 | default:"0.00" }}
                  {%endif%}
                {%endfor%}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
             
                {%for wallet in ref.referred.wallet.transactions.all%}
                  {%if wallet.welcome_amount%}
                    ₹{{wallet.welcome_amount | floatformat:2 | default:"0.00" }}
                  {%endif%}
                {%endfor%}
              </td>
            
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-sm text-gray-500">No referrals found.</p>
      {% endif %}
    </div>
  </div>
</div>


{% endblock %}