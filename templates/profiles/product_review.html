{% extends 'shared/profile_base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-2xl">
    <!-- Product Display Section -->
    <div class="bg-white shadow-md rounded-lg p-6 mb-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Product Details</h2>
        <div class="flex flex-col md:flex-row items-center">
            {% for image in  product.images.all %}
            {%if image.is_primary%}
                <img src="{{ image.image }}" alt="{{ product.name }}" class="w-32 h-32 object-cover rounded-md mr-4">
                {%endif%}
                {%empty%}
                  <div class="w-32 h-32 bg-gray-200 rounded-md flex items-center justify-center mr-4">
                    <span class="text-gray-500">No Image</span>
                </div>
            {% endfor %}
              
          
            <div>
                <h3 class="text-xl font-semibold text-gray-700">{{ product.name }}</h3>
                <p class="text-gray-600 mt-2">{{ product.description|truncatewords:30 }}</p>
                <p class="text-lg font-bold text-green-600 mt-2">&#8377; {{ product.price }}</p>
            </div>
        </div>
    </div>

    <!-- Review Form Section -->
    <div class="bg-white shadow-md rounded-lg p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Submit Your Review</h2>
        <form method="POST" action="{% url 'review_url' %}">
            {% csrf_token %}
            <input type="hidden" name="product_id" value="{{ product.id }}">

            <!-- Star Rating -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Rating:</label>
                <div class="flex flex-row-reverse justify-end space-x-1 space-x-reverse">
                    {% for i in "54321" %}
                        <input type="radio" name="rating" value="{{ i }}" id="star{{ i }}" class="hidden" required>
                        <label for="star{{ i }}" class="cursor-pointer text-2xl text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="{{ i }}">â˜…</label>
                    {% endfor %}
                </div>
            </div>

            <!-- Review Textarea -->
            <div class="mb-4">
                <label for="review" class="block text-gray-700 font-semibold mb-2">Review:</label>
                <textarea name="review" rows="5" class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-400" placeholder="Write your review here..." required></textarea>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors duration-200">Submit Review</button>
        </form>
    </div>
</div>

<!-- JavaScript for Interactive Star Rating -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    const stars = document.querySelectorAll('.flex label');
    stars.forEach(star => {
        star.addEventListener('click', () => {
            const rating = star.getAttribute('data-rating');
            stars.forEach(s => {
                const starRating = s.getAttribute('data-rating');
                s.classList.toggle('text-yellow-400', starRating <= rating);
                s.classList.toggle('text-gray-300', starRating > rating);
            });
        });
    });
});
</script>
{% endblock %}